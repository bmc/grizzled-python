<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>grizzled.config</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="grizzled-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="grizzled-module.html">Package&nbsp;grizzled</a> ::
        Module&nbsp;config
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="grizzled.config-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module config</h1><p class="nomargin-top"><span class="codelink"><a href="grizzled.config-pysrc.html">source&nbsp;code</a></span></p>
<pre class="literalblock">

Introduction
============

Based on the standard Python ``ConfigParser`` module, this module provides an
enhanced configuration parser capabilities. ``Configuration`` is a drop-in
replacement for ``ConfigParser``.

A configuration file is broken into sections, and each section is
introduced by a section name in brackets. For example::

    [main]
    installationDirectory=/usr/local/foo
    programDirectory: /usr/local/foo/programs

    [search]
    searchCommand: find /usr/local/foo -type f -name &quot;*.class&quot;

    [display]
    searchFailedMessage=Search failed, sorry.


Section Name Syntax
===================

A section name can consist of alphabetics, numerics, underscores and
periods. There can be any amount of whitespace before and after the
brackets in a section name; the whitespace is ignored.

Variable Syntax
===============

Each section contains zero or more variable settings.

 - Similar to a Java ``Properties`` file, the variables are specified as
   name/value pairs, separated by an equal sign (&quot;=&quot;) or a colon (&quot;:&quot;).
 - Variable names are case-sensitive and may contain alphabetics, numerics,
   underscores and periods (&quot;.&quot;).
 - Variable values may contain anything at all. Leading whitespace in the
   value is skipped. The way to include leading whitespace in a value is
   escape the whitespace characters with backslashes.

Variable Substitution
=====================

A variable value can interpolate the values of other variables, using a
variable substitution syntax. The general form of a variable reference is
``${section_name:var_name}``.

  - *section_name* is the name of the section containing the variable to
    substitute; if omitted, it defaults to the current section.
  - *var_name* is the name of the variable to substitute.

Default values
--------------

You can also specify a default value for a variable, using this syntax::

    ${foo?default}
    ${section:foo?default}

That is, the sequence ``?default`` after a variable name specifies the
default value if the variable has no value. (Normally, if a variable has
no value, it is replaced with an empty string.) Defaults can be useful,
for instance, to allow overrides from the environment. The following example
defines a log file directory that defaults to &quot;/tmp&quot;, unless environment
variable LOGDIR is set to a non-empty value::

    logDirectory: ${env:LOGDIR?/var/log}

Special section names
---------------------

The section names &quot;env&quot;, and &quot;program&quot; are reserved for special
pseudosections.

The ``env`` pseudosection
~~~~~~~~~~~~~~~~~~~~~~~~~

The &quot;env&quot; pseudosection is used to interpolate values from the environment. On
UNIX systems, for instance, ``${env:HOME}`` substitutes home directory of the
current user. On some versions of Windows, ``${env:USERNAME}`` will substitute
the name of the user.

Note: On UNIX systems, environment variable names are typically
case-sensitive; for instance, ``${env:USER}`` and ``${env:user}`` refer to
different environment variables. On Windows systems, environment variable
names are typically case-insensitive; ``${env:USERNAME}`` and
``${env:username}`` are equivalent.

The ``program`` pseudosection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The &quot;program&quot; pseudosection is a placeholder for various special variables
provided by the Configuration class. Those variables are:

``cwd``
    The current working directory. Thus, ``${program:cwd}`` will substitute
    the working directory, using the appropriate system-specific
    file separator (e.g., &quot;/&quot; on Unix, &quot;\&quot; on Windows).

``name``
    The calling program name. Equivalent to the Python expression
    ``os.path.basename(sys.argv[0])``

``now``
    The current time, formatted using the ``time.strftime()`` format
    ``&quot;%Y-%m-%d %H:%M:%S&quot;`` (e.g., &quot;2008-03-03 16:15:27&quot;)

Includes
--------

A special include directive permits inline inclusion of another
configuration file. The include directive takes two forms::

   %include &quot;path&quot;
   %include &quot;URL&quot;

For example::

    %include &quot;/home/bmc/mytools/common.cfg&quot;
    %include &quot;http://configs.example.com/mytools/common.cfg&quot;

The included file may contain any content that is valid for this parser. It
may contain just variable definitions (i.e., the contents of a section,
without the section header), or it may contain a complete configuration
file, with individual sections.

Note: Attempting to include a file from itself, either directly or
indirectly, will cause the parser to throw an exception.

Replacing ``ConfigParser``
==========================

You can use this class anywhere you would use the standard Python
``ConfigParser`` class. Thus, to change a piece of code to use enhanced
configuration, you might change this:

.. python::

    import ConfigParser

    config = ConfigParser.SafeConfigParser()
    config.read(configPath)

to this:

.. python::

    from grizzled.config import Configuration

    config = Configuration()
    config.read(configPath)


Sometimes, however, you have to use an API that expects a path to a
configuration file that can *only* be parsed with the (unenhanced)
``ConfigParser`` class. In that case, you simply use the ``preprocess()``
method:

.. python::

    import logging
    from grizzled import config

    logging.config.fileConfig(config.preprocess(pathToConfig))

That will preprocess the enhanced configuration file, producing a file
that is suitable for parsing by the standard Python ``config`` module.

</pre>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Classes</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Classes"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ConfigParser.NoOptionError-class.html" class="summary-name">NoOptionError</a><br />
      A requested option was not found.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="ConfigParser.NoSectionError-class.html" class="summary-name">NoSectionError</a><br />
      Raised when no section matches a requested option.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config.NoVariableError-class.html" class="summary-name">NoVariableError</a><br />
      Thrown when a configuration file attempts to substitute a nonexistent
variable, and the ``Configuration`` object was instantiated with
``strict_substitution`` set to ``True``.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config.Configuration-class.html" class="summary-name">Configuration</a><br />
      Configuration file parser.
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config._ConfigTemplate-class.html" class="summary-name" onclick="show_private();">_ConfigTemplate</a><br />
      Subclass of string.Template that handles our configuration variable
reference syntax.
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config._ConfigDict-class.html" class="summary-name" onclick="show_private();">_ConfigDict</a><br />
      Dictionary that knows how to dereference variables within a parsed config.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="grizzled.config-module.html#preprocess" class="summary-sig-name">preprocess</a>(<span class="summary-sig-arg">file_or_url</span>,
        <span class="summary-sig-arg">defaults</span>=<span class="summary-sig-default">None</span>)</span><br />
      This function preprocesses a file or URL for a configuration file,
processing all includes and substituting all variables.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="grizzled.config-pysrc.html#preprocess">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="log"></a><span class="summary-name">log</span> = <code title="logging.getLogger('grizzled.config')">logging.getLogger('grizzled.config')</code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="SECTION_OPTION_DELIM"></a><span class="summary-name">SECTION_OPTION_DELIM</span> = <code title="':'"><code class="variable-quote">'</code><code class="variable-string">:</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="SECTION_NAME_PATTERN"></a><span class="summary-name">SECTION_NAME_PATTERN</span> = <code title="'([_.a-zA-Z][_.a-zA-Z0-9]+)'"><code class="variable-quote">'</code><code class="variable-string">([_.a-zA-Z][_.a-zA-Z0-9]+)</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="VARIABLE_NAME_PATTERN"></a><span class="summary-name">VARIABLE_NAME_PATTERN</span> = <code title="'([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?'"><code class="variable-quote">'</code><code class="variable-string">([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config-module.html#VARIABLE_REF_PATTERN" class="summary-name" onclick="show_private();">VARIABLE_REF_PATTERN</a> = <code title="'([_.a-zA-Z][_.a-zA-Z0-9]+):([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?|([_a-z\
A-Z][_a-zA-Z0-9]+)(\\?[^}]+)?'"><code class="variable-quote">'</code><code class="variable-string">([_.a-zA-Z][_.a-zA-Z0-9]+):([_a-zA-Z][</code><code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="grizzled.config-module.html#SIMPLE_VARIABLE_REF_PATTERN" class="summary-name" onclick="show_private();">SIMPLE_VARIABLE_REF_PATTERN</a> = <code title="'\\$\\{([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?\\}'"><code class="variable-quote">'</code><code class="variable-string">\\$\\{([_a-zA-Z][_a-zA-Z0-9]+)(</code><code class="variable-ellipsis">...</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="ENV_SECTION"></a><span class="summary-name">ENV_SECTION</span> = <code title="'env'"><code class="variable-quote">'</code><code class="variable-string">env</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="PROGRAM_SECTION"></a><span class="summary-name">PROGRAM_SECTION</span> = <code title="'program'"><code class="variable-quote">'</code><code class="variable-string">program</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="None">None</code><br />
      hash(x)
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="preprocess"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">preprocess</span>(<span class="sig-arg">file_or_url</span>,
        <span class="sig-arg">defaults</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="grizzled.config-pysrc.html#preprocess">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

This function preprocesses a file or URL for a configuration file,
processing all includes and substituting all variables. It writes a new
configuration file to a temporary file (or specified output file). The
new configuration file can be read by a standard ``ConfigParser``
object. Thus, this method is useful when you have an extended
configuration file that must be passed to a function or object that can
only read a standard ``ConfigParser`` file.

For example, here's how you might use the Python ``logging`` API with an
extended configuration file:

.. python::

    from grizzled.config import Configuration
    import logging

    logging.config.fileConfig(Configuration.preprocess('/path/to/config')

:Parameters:
    file_or_url :  str
       file or URL to read and preprocess
    defaults : dict
        defaults to pass through to the config parser

:rtype: string
:return: Path to a temporary file containing the expanded configuration.
         The file will be deleted when the program exits, though the caller
         is free to delete it sooner.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-VariablesDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="VARIABLE_REF_PATTERN"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">VARIABLE_REF_PATTERN</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-quote">'</code><code class="variable-string">([_.a-zA-Z][_.a-zA-Z0-9]+):([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?|([_a-z</code><span class="variable-linewrap"><img src="crarr.png" alt="\" /></span>
<code class="variable-string">A-Z][_a-zA-Z0-9]+)(\\?[^}]+)?</code><code class="variable-quote">'</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<a name="SIMPLE_VARIABLE_REF_PATTERN"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">SIMPLE_VARIABLE_REF_PATTERN</h3>
  
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-quote">'</code><code class="variable-string">\\$\\{([_a-zA-Z][_a-zA-Z0-9]+)(\\?[^}]+)?\\}</code><code class="variable-quote">'</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="grizzled-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sun Mar 13 09:46:08 2011
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
